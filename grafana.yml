---

# - hosts: docker01_server
#   gather_facts: False
#   become: true
#   become_user: root
#   tasks:

#     - name: adicionar conexão com o container grafana
#       add_host:
#         name: grafana
#         groups: "docker_container"
#         ansible_connection: docker
#         ansible_user: root
#       changed_when: false    

# setup the new machine using ansible instead of docker
- hosts: docker_container_1
  gather_facts: False
  pre_tasks:
    - name: Install python for Ansible
      raw: test -e /usr/bin/python3 || (apt -y update && apt install -y python3 python3-apt)
      register: output
      changed_when: output.stdout != ""
    - setup: # aka gather_facts
  tasks:
    - name: atualiza todos os pacotes para a última versão
      apt:
        update_cache: yes
        upgrade: full
        force_apt_get: yes